package Test;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Properties;

public class MysqlConnect {
    // init database constants
    private static final String DATABASE_DRIVER = "com.mysql.jdbc.Driver";
    private static final String DATABASE_URL = "jdbc:mysql://localhost:3306/userDB";
    private static final String USERNAME = "root";
    private static final String PASSWORD = "1111";
    private static final String MAX_POOL = "250";
    private static int MAX_VALUE = 10;

    // init connection object
    private Connection connection;
    // init properties object
    private Properties properties;

    // create properties
    private Properties getProperties() {
        if (properties == null) {
            properties = new Properties();
            properties.setProperty("user", USERNAME);
            properties.setProperty("password", PASSWORD);
            properties.setProperty("MaxPooledStatements", MAX_POOL);
        }
        return properties;
    }

    // connect database
    public Connection connect()   {
        if (connection == null) {
            try {
              //  Class.forName("com.mysql.jdbc.Driver");
                connection = DriverManager.getConnection(DATABASE_URL, getProperties());
            } catch ( //ClassNotFoundException |
            		SQLException e) {
                e.printStackTrace();
            }
        }
        return connection;
    }

    // disconnect database
    public void disconnect() {
        if (connection != null) {
            try {
                connection.close();
                connection = null;
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
    public static void main(String[] args) {
    	MysqlConnect mysqlConnect = new MysqlConnect();
    	
    	String sql = "INSERT INTO userDB.TEST (FIELD) VALUES (?)";
    	try {
    	    PreparedStatement preparedStatement = mysqlConnect.connect().prepareStatement(sql);
    	    for (int i = 0; i < MAX_VALUE; i++) {
				preparedStatement.setInt(1, i);

				// ...
				preparedStatement.addBatch();

				if ((i + 1) % 1000 == 0) {

					preparedStatement.executeBatch(); // Execute every 10 items.
				}
			}
			preparedStatement.executeBatch(); 
    	} catch (SQLException e) {
    	    e.printStackTrace();
    	} finally {
    	    mysqlConnect.disconnect();
    	}
	}
}